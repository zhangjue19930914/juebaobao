M.add("uix-sticky",function(a){function b(b,c){var d={mainAreaWidth:980,hideWhenTooNarrow:!1,canDisappear:!1,hAlign:"left",hLeftOffset:10,hRightOffset:10,vAlign:"top",vTopOffset:0,vBottomOffset:0,vMinScrollTop:0,topEdge:null,isStaticBottomEdge:!1,bottomEdge:"#ft",side:"right"};if(c.topEdge&&a.Lang.isNumber(c.topEdge)===!1){var e=a.one(c.topEdge);e&&(this._topEdgeNode=e,c.topEdge=e.getY())}if(this.ndHost=a.one(b),this.config=a.merge(d,c),!this.ndHost)throw new Error("Y.mt.uix.Sticky: 没有设置ndHost或ndHost不存在");if(a.Lang.isNumber(this.config.bottomEdge)&&!this.config.isStaticBottomEdge)throw new Error("Y.mt.uix.Sticky: isStaticBottomEdge为false时，bottomEdge不能为数字");var f=a.mt.UIUtil.getDimensions(b);this._hostHeight=f.offsetHeight,this._hostWidth=f.offsetWidth,this._topEdge=this.config.topEdge,this._delta=10,this.shouldShow={horizontal:!0,vertical:!0},this._handlers={},this._bindEvent()}var c=a.mt.util,d=6===a.UA.ie,e="px";b.prototype={_bindEvent:function(){function b(){e._destroy||(e._handleDisplay(),e._alignVertical())}function d(){e._destroy||(e._handleDisplay(),e._alignVertical(),e._alignHorizontal())}var e=this;e._align(),e._handleDisplay(),a.Global.on("PageHeight:change",function(){window.setTimeout(function(){e.config.isStaticBottomEdge&&e._getBottomEdge(!0),b()},50)}),window.setTimeout(d,200),a.mt.util.addLoadListener(function(){e._getBottomEdge(!0)});var f=a.one(window);this._handlers.scroll=f.on("scroll",c.throttle(b)),this._handlers.resize=f.on("resize",c.throttle(d))},isVisible:function(){var a=this;return a.shouldShow.vertical&&a.shouldShow.horizontal},_hideCanDisappear:function(){if(this.config.canDisappear){var a=this.ndHost,b=this.config.vMinScrollTop,c=parseInt(a.get("docScrollY"),10);this.shouldShow.vertical=c>=b}},_hideWhenNarrow:function(){if(this.config.hideWhenTooNarrow){var b,c=this._hostWidth,d=a.one(window).get("winWidth"),e=this.config,f=parseInt(e.mainAreaWidth,10),g=parseInt(e.hLeftOffset,10),h=parseInt(e.hRightOffset,10);b="right"===e.hAlign?h:g,this.shouldShow.horizontal=(d-f)/2>=c+b}},_handleDisplay:function(){var a=this.ndHost;this._hideCanDisappear(),this._hideWhenNarrow(),this.isVisible()?a.show():a.hide()},_alignHorizontal:function(){if(this.isVisible()){var b=this,c=b.ndHost,d=b.config,f=parseInt(d.mainAreaWidth,10),g=parseInt(d.hLeftOffset,10),h=parseInt(d.hRightOffset,10),i=a.one(window),j=i.get("winWidth"),k=b._hostWidth;"right"===d.side?"right"===d.hAlign?c.setStyle("right",d.hRightOffset+e):k+g>(j-f)/2?c.setStyle("left",j-k-g+e):c.setStyle("left",(j+f)/2+g+e):"left"===d.hAlign?c.setStyle("left",g+e):k+h>(j-f)/2?c.setStyle("right",j-k-h+e):c.setStyle("right",(j+f)/2+h+e)}},_alignVertical:function(){if(this.isVisible()){var b,c,f=this,g=this.config,h=this.ndHost,i=a.one(window),j=i.get("winHeight"),k=parseInt(g.vBottomOffset,10),l=g.vAlign,m=h.get("docScrollY"),n=parseInt(f._getBottomEdge(),10),o=f._topEdge,p=f._topEdgeNode,q=f._delta,r=f._hostStyleTop,s=f._hostHeight;p&&(o=p.getY());var t=m+j-n;d?("bottom"===l?(b=m+j-(k+s),o&&o>b?b=o:t>0&&(b-=t)):(b=m+r,n&&s+b+k>n?b=n-s-k:o&&o>b?b=o:t>0&&b+s>n&&(b=n-s-q)),h.setStyle("top",b+e)):"bottom"===l?(c=k,o&&o-m>j-(s+c)?c=j-(o-m)-s:t>0&&(c+=t),h.setStyle("bottom",c+e)):(b=r,n&&m+s+b+k>n?b=n-m-s-k:o&&o>m+b?b=o-m:t>0&&m+b+s>n&&(b=n-m-s-q),h.setStyle("top",b+e))}},_align:function(){var b=this,c=b.config,d=b._delta,e=parseInt(c.vTopOffset,10),f=e,g=a.one(window),h=g.get("winHeight"),i=b._hostHeight;f&&(f=e+i>h?h-i-d:e),b._hostStyleTop=f,b._alignVertical(),b._alignHorizontal()},_getBottomEdge:function(b){var c=this,d=this.config,e=d.bottomEdge,f=d.isStaticBottomEdge,g=c.ndHost.get("docHeight"),h=a.one(e),i=e;if(f){if(c._staticBottomEdge&&!b)return c._staticBottomEdge;i=a.Lang.isNumber(e)?parseInt(e,10):h?h.getY():g,c._staticBottomEdge=i}else i=h?h.getY():g;return i},destroy:function(){this._destroy=!0,c.detachHandle(this._handlers)}},a.namespace("mt.uix"),a.mt.uix.Sticky=b},"1.0.0",{requires:["mt-base","mt-uiutil","node"]});